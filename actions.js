const dgram = require('dgram')

const packets = {
	0: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000000062',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000021',
	],
	1: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000288e',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000004d',
	],
	2: [
		'9800002b8000000001010000000000000000000000000000000000000000000000000000000000000035c7',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000086',
	],
	3: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000003f0a',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000c9',
	],
	4: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000004654',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000013',
	],
	5: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000004da5',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000064',
	],
	6: [
		'9800002b8000000001010000000000000000000000000000000000000000000000000000000000000053fc',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000bb',
	],
	7: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000005858',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000017',
	],
	8: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000005db9',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000078',
	],
	9: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000611e',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000dd',
	],
	10: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000006688',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000047',
	],
	11: [
		'9800002b8000000001010000000000000000000000000000000000000000000000000000000000000069f5',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000b4',
	],
	12: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000006d66',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000025',
	],
	13: [
		'9800002b8000000001010000000000000000000000000000000000000000000000000000000000000071db',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000009a',
	],
	14: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000007453',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000012',
	],
	15: [
		'9800002b8000000001010000000000000000000000000000000000000000000000000000000000000077ce',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000008d',
	],
	16: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000007b4d',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000000c',
	],
	17: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000007ecf',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000008e',
	],
	18: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000008053',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000012',
	],
	19: [
		'9800002b8000000001010000000000000000000000000000000000000000000000000000000000000083da',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000099',
	],
	20: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000008664',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000023',
	],
	21: [
		'9800002b8000000001010000000000000000000000000000000000000000000000000000000000000089f1',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000b0',
	],
	22: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000008b80',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000003f',
	],
	23: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000008e12',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000d1',
	],
	24: [
		'9800002b8000000001010000000000000000000000000000000000000000000000000000000000000090a6',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000065',
	],
	25: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000923c',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000fb',
	],
	26: [
		'9800002b8000000001010000000000000000000000000000000000000000000000000000000000000095d5',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000094',
	],
	27: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000009770',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000002f',
	],
	28: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000990d',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000cc',
	],
	29: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000009bac',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000006b',
	],
	30: [
		'9800002b800000000101000000000000000000000000000000000000000000000000000000000000009e4e',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000000d',
	],
	31: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000a0f2',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000b1',
	],
	32: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000a298',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000057',
	],
	33: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000a440',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ff',
	],
	34: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000a6ea',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000a9',
	],
	35: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000a896',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000055',
	],
	36: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000a943',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000002',
	],
	37: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000abf2',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000b1',
	],
	38: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000ada3',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000062',
	],
	39: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000af56',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000015',
	],
	40: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000b10b',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ca',
	],
	41: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000b3c2',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000081',
	],
	42: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000b47a',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000039',
	],
	43: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000b634',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000f3',
	],
	44: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000b8f0',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000af',
	],
	45: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000b9ad',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000006c',
	],
	46: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000bb6c',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000002b',
	],
	47: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000bd2d',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ec',
	],
	48: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000beef',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ae',
	],
	49: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000c0b3',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000072',
	],
	50: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000c178',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000037',
	],
	51: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000c33f',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000fe',
	],
	52: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000c407',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000c6',
	],
	53: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000c6d1',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000090',
	],
	54: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000c79c',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000005b',
	],
	55: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000c969',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000028',
	],
	56: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000ca37',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000f6',
	],
	57: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000cc07',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000c6',
	],
	58: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000cdd8',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000097',
	],
	59: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000ceaa',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000069',
	],
	60: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000d07e',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000003d',
	],
	61: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000d153',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000012',
	],
	62: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000d32a',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000e9',
	],
	63: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000d402',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000c1',
	],
	64: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000d5db',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000009a',
	],
	65: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000d7b6',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000075',
	],
	66: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000d892',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000051',
	],
	67: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000d96f',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000002e',
	],
	68: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000db4e',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000000d',
	],
	69: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000dc2e',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ed',
	],
	70: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000dd0f',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ce',
	],
	71: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000def1',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000b0',
	],
	72: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000e0d5',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000094',
	],
	73: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000e1ba',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000079',
	],
	74: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000e2a0',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000005f',
	],
	75: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000e387',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000046',
	],
	76: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000e46f',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000002e',
	],
	77: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000e659',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000018',
	],
	78: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000e744',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000003',
	],
	79: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000e830',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ef',
	],
	80: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000e91d',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000dc',
	],
	81: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000ea0b',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ca',
	],
	82: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000ecfb',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ba',
	],
	83: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000edec',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000ab',
	],
	84: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000eede',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000009d',
	],
	85: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000efd1',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000090',
	],
	86: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000f0c5',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000084',
	],
	87: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000f1ba',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000079',
	],
	88: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000f2b0',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000006f',
	],
	89: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000f3a7',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000066',
	],
	90: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000f49f',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000005e',
	],
	91: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000f699',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000058',
	],
	92: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000f794',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000053',
	],
	93: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000f890',
		'9800002bfa000000010100000000000000000000000000000000000000000000000000000000000000004f',
	],
	94: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000f93e',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000fd',
	],
	95: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000fa3c',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000fb',
	],
	96: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000fb3b',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000fa',
	],
	97: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000fc3b',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000fa',
	],
	98: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000fd3c',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000fb',
	],
	99: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000fe3e',
		'9800002bfa00000001010000000000000000000000000000000000000000000000000000000000000000fd',
	],
	100: [
		'9800002b80000000010100000000000000000000000000000000000000000000000000000000000000ff41',
		'9800002bfa0000000101000000000000000000000000000000000000000000000000000000000000000000',
	],
}

const freezePackets = {
	ON: ['8411223344010000', '8411223344010000'],
	OFF: ['8411223344000000', '8411223344000000'],
}

const blackoutPackets = {
	ON: ['8111223344000000', '8111223344000000'],
	OFF: ['8111223344010000', '8111223344010000'],
}

/**
 * General UDP send function
 */
function sendPackets(self, packetArray) {
	const ip = self.config.host
	const port = parseInt(self.config.port)

	if (!ip || !port) {
		self.log('error', 'IP or port not configured!')
		return
	}

	const client = dgram.createSocket('udp4')

	for (const hex of packetArray) {
		try {
			const payload = Buffer.from(hex, 'hex')
			client.send(payload, port, ip, (err) => {
				if (err) self.log('error', err.message)
			})
		} catch (err) {
			self.log('error', `Hex conversion error: ${err.message}`)
		}
	}

	self.log('debug', `UDP sent to ${ip}:${port}`)

	setTimeout(() => {
		client.close()
	}, 50)
}

module.exports = function (self) {
	self.setActionDefinitions({
		/*
		 * ============================
		 * SET BRIGHTNESS
		 * ============================
		 */
		set_brightness: {
			name: 'Set Brightness',
			options: [
				{
					id: 'brightness',
					type: 'number',
					label: 'Brightness (%)',
					min: 0,
					max: 100,
					default: 50,
				},
			],
			callback: async (event) => {
				const brightness = event.options.brightness

				if (!packets.hasOwnProperty(brightness)) {
					self.log('error', `Brightness ${brightness}% not available in mapping.`)
					return
				}

				sendPackets(self, packets[brightness])

				self.log('info', `Brightness ${brightness}% sent`)
			},
		},

		/*
		 * ============================
		 * FREEZE
		 * ============================
		 */
		freeze: {
			name: 'Freeze',
			options: [
				{
					id: 'state',
					type: 'dropdown',
					label: 'State',
					default: 'ON',
					choices: [
						{ id: 'ON', label: 'ON' },
						{ id: 'OFF', label: 'OFF' },
					],
				},
			],
			callback: async (event) => {
				const state = event.options.state
				const packetsToSend = freezePackets[state]

				if (!packetsToSend) {
					self.log('error', `Invalid freeze state: ${state}`)
					return
				}

				sendPackets(self, packetsToSend)

				self.log('info', `Freeze ${state} sent`)
			},
		},

		/*
		 * ============================
		 * BLACKOUT
		 * ============================
		 */
		blackout: {
			name: 'Blackout',
			options: [
				{
					id: 'state',
					type: 'dropdown',
					label: 'State',
					default: 'ON',
					choices: [
						{ id: 'ON', label: 'ON' },
						{ id: 'OFF', label: 'OFF' },
					],
				},
			],
			callback: async (event) => {
				const state = event.options.state
				const packetsToSend = blackoutPackets[state]

				if (!packetsToSend) {
					self.log('error', `Invalid blackout state: ${state}`)
					return
				}

				sendPackets(self, packetsToSend)

				self.log('info', `Blackout ${state} sent`)
			},
		},

		/*
		* ============================
		* ADJUST BRIGHTNESS (+/-)
		* ============================
		*/
		brightness_adjust: {
			name: 'Adjust Brightness (+/-)',
			options: [
				{
					id: 'delta',
					type: 'number',
					label: 'Adjustment (+/-)',
					default: 1,
					min: -100,
					max: 100,
				},
			],
			callback: async (event) => {
				const current = parseInt(self.getVariableValue('brightness')) || 0
				let newValue = current + parseInt(event.options.delta)

				// Clamp 0â€“100
				if (newValue > 100) newValue = 100
				if (newValue < 0) newValue = 0

				if (!packets.hasOwnProperty(newValue)) {
					self.log('error', `Brightness ${newValue}% not available in mapping.`)
					return
				}

				sendPackets(self, packets[newValue])

				// update variable
				self.setVariableValues({ brightness: newValue })
				self.checkFeedbacks('brightness_level')

				self.log('info', `Brightness adjusted to ${newValue}%`)
			},
		},

		/*
		* ============================
		* Test Pattern
		* ============================
		*/
		test_pattern: {
			name: 'Send Test Pattern',
			options: [
				{
					id: 'pattern',
					type: 'dropdown',
					label: 'Choose Pattern',
					default: 0,
					choices: [
						{ id: 0,  label: 'Normal' },
						{ id: 1,  label: 'Red' },
						{ id: 2,  label: 'Green' },
						{ id: 3,  label: 'Blue' },
						{ id: 4,  label: 'White' },
						{ id: 5,  label: 'Vertical Line' },
						{ id: 6,  label: 'Horizontal Line' },
						{ id: 7,  label: 'Left Slash' },
						{ id: 8,  label: 'Right Slash' },
						{ id: 9,  label: 'Pane' },
						{ id: 10, label: 'Gradient Red' },
						{ id: 11, label: 'Gradient Green' },
						{ id: 12, label: 'Gradient Blue' },
						{ id: 13, label: 'Gradient White' },
						{ id: 14, label: 'Black' },
					],
				},
			],
			callback: async (event) => {
				const patternId = Number(event.options.pattern)

				const packet = Buffer.from([
					0x99, 0x00, 0x00, 0x0b,
					0x03, 0x00, 0x00,
					patternId,
					0xff, 0xff, 0xff,
					0xa4 + patternId
				])

				sendPackets(self, [packet.toString('hex')])
				self.log('info', `Test Pattern ${patternId} sent`)
			},
		},

	})
}